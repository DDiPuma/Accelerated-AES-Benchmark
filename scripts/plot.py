#!/usr/bin/env python3

# Raw data from run_bench.py output

data_laptop = {
    'bench_cpu': {
        1024: 421.8440506,
        2048: 1.88808,
        4096: 1.8561705,
        8192: 1.8980987,
        16384: 2.105818,
        32768: 2.4764448,
        65536: 2.9677227000000004,
        131072: 4.0577324,
        262144: 5.8735946,
        524288: 9.2167984,
        1048576: 15.1559498,
        2097152: 27.8193743,
        4194304: 52.3406628,
        8388608: 100.670684,
        16777216: 198.86603730000002,
        33554432: 392.048447,
        67108864: 785.1693066,
        134217728: 1555.9025672,
        268435456: 3088.8204349000002,
        536870912: 6157.1495782,
        1073741824: 12981.835066799998,
        2147483648: 27663.3925985,
        4294967296: 54167.0494977,
        8589934592: 114561.4593067},
    'bench_cl': {
        1024: 524.6983389,
        2048: 10.372553199999999,
        4096: 10.9521781,
        8192: 11.4617586,
        16384: 11.6512528,
        32768: 11.157620699999999,
        65536: 10.7037725,
        131072: 11.664592599999999,
        262144: 14.101735099999999,
        524288: 16.1523251,
        1048576: 20.4787356,
        2097152: 27.504319199999998,
        4194304: 46.1269052,
        8388608: 79.6025303,
        16777216: 148.09166480000002,
        33554432: 285.17997030000004,
        67108864: 559.9334355,
        134217728: 1092.978893,
        268435456: 2165.3604591,
        536870912: 4428.9694417,
        1073741824: 9223.8854313,
        2147483648: 26819.039721200003,
        4294967296: 54193.80990769999,
        8589934592: 120746.7118038},
    'bench_ni': {
        1024: 438.18086919999996,
        2048: 2.199031,
        4096: 2.1318445,
        8192: 2.1827438999999997,
        16384: 2.1627575,
        32768: 2.2386068999999997,
        65536: 2.4203177,
        131072: 2.7329364,
        262144: 2.9240205,
        524288: 3.7941467999999996,
        1048576: 5.0426766,
        2097152: 6.8669468,
        4194304: 11.346203699999998,
        8388608: 20.033989899999998,
        16777216: 37.0376622,
        33554432: 71.5490022,
        67108864: 139.3358588,
        134217728: 277.7887605,
        268435456: 566.1668987,
        536870912: 1130.3467252,
        1073741824: 3244.579557,
        2147483648: 7461.7690797,
        4294967296: 18185.227636400003,
        8589934592: 40467.1806844}}

data_aws = {
    'bench_cpu': {
        1024: 530.9652684,
        2048: 1.343516,
        4096: 1.2865453,
        8192: 1.3212507,
        16384: 1.44446,
        32768: 1.5813194,
        65536: 1.8312595,
        131072: 2.4345412000000004,
        262144: 3.7378355,
        524288: 6.8105856,
        1048576: 11.9576991,
        2097152: 21.0112952,
        4194304: 40.5793594,
        8388608: 86.7785334,
        16777216: 173.65101180000002,
        33554432: 329.3855543,
        67108864: 672.1453807,
        134217728: 1333.2746427,
        268435456: 2653.4934946,
        536870912: 7312.4708793,
        1073741824: 15651.6386172,
        2147483648: 17807.178211,
        4294967296: 35842.608490800005,
        8589934592: 76128.23603089999},
    'bench_cl': {
        1024: 628.6633001,
        2048: 150.9315379,
        4096: 149.770964,
        8192: 150.50445159999998,
        16384: 148.8962544,
        32768: 148.26282659999998,
        65536: 148.3020427,
        131072: 148.6957343,
        262144: 148.2105051,
        524288: 148.2495284,
        1048576: 149.5506751,
        2097152: 150.8591455,
        4194304: 160.2549313,
        8388608: 174.2048375,
        16777216: 198.799181,
        33554432: 252.6645261,
        67108864: 376.93386039999996,
        134217728: 583.4957695,
        268435456: 1842.8317270999999,
        536870912: 4089.7308174,
        1073741824: 8734.751875700002,
        2147483648: 2972.1308796999997,
        4294967296: 15294.5170761,
        8589934592: 62314.6007337},
    'bench_ni': {
        1024: 559.702298,
        2048: 1.5870968,
        4096: 1.3474466,
        8192: 1.494734,
        16384: 1.3161338,
        32768: 1.3349174,
        65536: 1.526563,
        131072: 1.5077378000000001,
        262144: 1.6735919,
        524288: 2.5119358,
        1048576: 4.0754267,
        2097152: 6.2789713,
        4194304: 11.3181581,
        8388608: 28.8837678,
        16777216: 55.8139145,
        33554432: 123.8634284,
        67108864: 260.200198,
        134217728: 998.3255889,
        268435456: 2044.3389525,
        536870912: 4190.0037078000005,
        1073741824: 9254.717761700002,
        2147483648: 4298.6954842,
        4294967296: 12820.845666700001,
        8589934592: 58651.1292766}}

import matplotlib.pyplot as plt

if __name__ == "__main__":
    datas = {"Laptop": data_laptop, "AWS": data_aws}
    
    for name, data in datas.items():
        sizes = list(data["bench_cl"].keys())
        cl_times = list(data["bench_cl"].values())
        cpu_times = list(data["bench_cpu"].values())
        ni_times = list(data["bench_ni"].values())

        plt.figure()
        plt.loglog(sizes, cpu_times, "bo",
                sizes, cl_times, "rs",
                sizes, ni_times, "g^")
        
        plt.legend(["Plain C", "OpenCL/GPU", "AES-NI"])

        plt.xlabel("File Size (bytes)")
        plt.ylabel("Average time to encrypt across 10 executions (msec)");
        plt.title(f"Runtime Comparison for AES-128 Encryption Implementations ({name})")
        
        plt.show()
