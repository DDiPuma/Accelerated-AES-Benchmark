#!/usr/bin/env python3

# Raw data from run_bench.py output

data_laptop = {
    'bench_cl':
        {1024: 714.9351763,
         2048: 9.973813199999999,
         4096: 12.1379285,
         8192: 11.1411211,
         16384: 11.208098699999999,
         32768: 12.1022213,
         65536: 13.254444900000001,
         131072: 12.0357731,
         262144: 14.9032152,
         524288: 18.3779677,
         1048576: 20.695623899999998,
         2097152: 30.1447428,
         4194304: 44.8067392,
         8388608: 84.353669,
         16777216: 157.4932307,
         33554432: 271.41645969999996,
         67108864: 553.2066671,
         134217728: 1152.5416542,
         268435456: 2047.6750722000002,
         536870912: 3998.9797524,
         1073741824: 10116.623656700001,
         2147483648: 28060.7828893,
         4294967296: 55538.5938169,
         8589934592: 105993.3059011},
    'bench_cpu':
        {1024: 675.9844244,
         2048: 2.293824,
         4096: 2.1991169,
         8192: 2.094236,
         16384: 2.117215,
         32768: 2.3456489,
         65536: 3.135094,
         131072: 4.6234275,
         262144: 6.0444648,
         524288: 9.024349599999999,
         1048576: 16.8544278,
         2097152: 28.9208954,
         4194304: 53.123067799999994,
         8388608: 102.0494983,
         16777216: 199.658469,
         33554432: 392.7948552,
         67108864: 878.572355,
         134217728: 1809.5920859,
         268435456: 3551.7459059000003,
         536870912: 6455.883287899999,
         1073741824: 13329.644676700002,
         2147483648: 27229.8206199,
         4294967296: 54802.3657419,
         8589934592: 111838.5075323},
    'bench_gcrypt':
        {1024: 672.5972952000001,
         2048: 2.2477848,
         4096: 2.5629982,
         8192: 2.6025714,
         16384: 2.5349632,
         32768: 2.6232181,
         65536: 2.809153,
         131072: 3.135305,
         262144: 3.309894,
         524288: 4.2070246,
         1048576: 5.304045299999999,
         2097152: 7.24063,
         4194304: 12.030577,
         8388608: 21.050662199999998,
         16777216: 37.4553207,
         33554432: 71.716895,
         67108864: 174.3537698,
         134217728: 349.36911280000004,
         268435456: 653.7443117,
         536870912: 1220.6209619,
         1073741824: 3813.2259534,
         2147483648: 8645.5300064,
         4294967296: 21891.5783199,
         8589934592: 50502.702330199994},
    'bench_ni':
        {1024: 674.5758423999999,
         2048: 2.2115016,
         4096: 2.2398713,
         8192: 2.2473841,
         16384: 2.1653015,
         32768: 2.1896826000000003,
         65536: 2.6394306000000003,
         131072: 3.026367,
         262144: 3.0640382,
         524288: 3.8674564,
         1048576: 5.1390968,
         2097152: 7.0262735,
         4194304: 11.7973831,
         8388608: 20.6994241,
         16777216: 37.671381,
         33554432: 71.97144209999999,
         67108864: 140.08426219999998,
         134217728: 280.6791714,
         268435456: 724.4559192,
         536870912: 2127.6290672,
         1073741824: 4066.9754417,
         2147483648: 9147.4953689,
         4294967296: 21632.8580295,
         8589934592: 46861.815218}}


data_aws = {
    'bench_cpu': {
        1024: 1229.9503534,
         2048: 2.2260107999999996,
         4096: 1.9959506,
         8192: 2.2462106,
         16384: 2.2346307999999997,
         32768: 2.530045,
         65536: 2.7465871,
         131072: 3.3897691,
         262144: 4.384147400000001,
         524288: 7.1713414,
         1048576: 12.0541041,
         2097152: 23.7253392,
         4194304: 42.853023,
         8388608: 82.9154522,
         16777216: 167.7384455,
         33554432: 325.76840569999996,
         67108864: 651.7804775,
         134217728: 1713.5776442000001,
         268435456: 2481.1655398000003,
         536870912: 7991.3528412,
         1073741824: 16116.2894135,
         2147483648: 18445.9865462,
         4294967296: 41864.7807468,
         8589934592: 93902.0534868},
    'bench_gcrypt': {
        1024: 1284.5309742,
         2048: 3.1275612,
         4096: 2.6063376000000003,
         8192: 2.9674652999999998,
         16384: 2.0435592,
         32768: 2.9417921000000002,
         65536: 2.4823672,
         131072: 2.6727557,
         262144: 2.5347288999999997,
         524288: 4.4308757000000005,
         1048576: 5.088377599999999,
         2097152: 8.858260099999999,
         4194304: 19.54365,
         8388608: 34.3164611,
         16777216: 62.431044799999995,
         33554432: 120.1201243,
         67108864: 290.9731603,
         134217728: 1453.5810089000001,
         268435456: 2906.5366364,
         536870912: 4370.6398106999995,
         1073741824: 11464.8784995,
         2147483648: 9620.1792056,
         4294967296: 27510.5461636,
         8589934592: 59916.7093298},
    'bench_ni': {
        1024: 1110.4567253,
         2048: 2.1693521000000002,
         4096: 2.037514,
         8192: 2.0332391000000003,
         16384: 2.1482101,
         32768: 2.1577759,
         65536: 2.0981758999999998,
         131072: 2.2504001000000002,
         262144: 2.754996,
         524288: 3.8299986,
         1048576: 5.395806599999999,
         2097152: 10.7910953,
         4194304: 16.8748494,
         8388608: 31.7929109,
         16777216: 55.6157118,
         33554432: 109.8582562,
         67108864: 758.7976034,
         134217728: 1967.1918378,
         268435456: 2321.2285389,
         536870912: 7563.785796300001,
         1073741824: 15612.3785426,
         2147483648: 16452.755162,
         4294967296: 35759.0010683,
         8589934592: 87261.46745319999},
    'bench_cl': {1024: 1350.6185505,
         2048: 149.6613195,
         4096: 151.2827624,
         8192: 151.58560369999998,
         16384: 152.4997303,
         32768: 151.5155923,
         65536: 154.652712,
         131072: 154.807951,
         262144: 154.4444796,
         524288: 155.5926996,
         1048576: 158.6554714,
         2097152: 169.506609,
         4194304: 179.51425740000002,
         8388608: 213.6810303,
         16777216: 267.4837908,
         33554432: 373.068503,
         67108864: 580.9688258,
         134217728: 1464.5653985,
         268435456: 3690.9332901,
         536870912: 7393.123418,
         1073741824: 15241.4052973,
         2147483648: 16061.223650799999,
         4294967296: 37649.455326300005,
         8589934592: 71246.89045}}


import matplotlib.pyplot as plt

if __name__ == "__main__":
    datas = {"Laptop": data_laptop, "AWS": data_aws}
    
    for name, data in datas.items():
        sizes = list(data["bench_cl"].keys())
        cl_times = list(data["bench_cl"].values())
        cpu_times = list(data["bench_cpu"].values())
        ni_times = list(data["bench_ni"].values())
        gcrypt_times = list(data["bench_gcrypt"].values())

        plt.figure()
        plt.loglog(sizes, cpu_times, "bo",
                sizes, cl_times, "g^",
                sizes, ni_times, "rs",
                sizes, gcrypt_times, "kx")
        
        plt.legend(["Custom C", "OpenCL/GPU", "AES-NI", "gcrypt"])

        plt.xlabel("File Size (bytes)")
        plt.ylabel("Average time to encrypt across 10 executions (msec)");
        plt.title(f"Runtime Comparison for AES-128 Encryption Implementations ({name})")
        
        plt.show()
