#!/usr/bin/env python3

# Raw data from run_bench.py output

data_laptop = {'bench_cl': {1024: 714.9351763, 2048: 9.973813199999999, 4096: 12.1379285, 8192: 11.1411211, 16384: 11.208098699999999, 32768: 12.1022213, 65536: 13.254444900000001, 131072: 12.0357731, 262144: 14.9032152, 524288: 18.3779677, 1048576: 20.695623899999998, 2097152: 30.1447428, 4194304: 44.8067392, 8388608: 84.353669, 16777216: 157.4932307, 33554432: 271.41645969999996, 67108864: 553.2066671, 134217728: 1152.5416542, 268435456: 2047.6750722000002, 536870912: 3998.9797524, 1073741824: 10116.623656700001, 2147483648: 28060.7828893, 4294967296: 55538.5938169, 8589934592: 105993.3059011}, 'bench_cpu': {1024: 675.9844244, 2048: 2.293824, 4096: 2.1991169, 8192: 2.094236, 16384: 2.117215, 32768: 2.3456489, 65536: 3.135094, 131072: 4.6234275, 262144: 6.0444648, 524288: 9.024349599999999, 1048576: 16.8544278, 2097152: 28.9208954, 4194304: 53.123067799999994, 8388608: 102.0494983, 16777216: 199.658469, 33554432: 392.7948552, 67108864: 878.572355, 134217728: 1809.5920859, 268435456: 3551.7459059000003, 536870912: 6455.883287899999, 1073741824: 13329.644676700002, 2147483648: 27229.8206199, 4294967296: 54802.3657419, 8589934592: 111838.5075323}, 'bench_gcrypt': {1024: 672.5972952000001, 2048: 2.2477848, 4096: 2.5629982, 8192: 2.6025714, 16384: 2.5349632, 32768: 2.6232181, 65536: 2.809153, 131072: 3.135305, 262144: 3.309894, 524288: 4.2070246, 1048576: 5.304045299999999, 2097152: 7.24063, 4194304: 12.030577, 8388608: 21.050662199999998, 16777216: 37.4553207, 33554432: 71.716895, 67108864: 174.3537698, 134217728: 349.36911280000004, 268435456: 653.7443117, 536870912: 1220.6209619, 1073741824: 3813.2259534, 2147483648: 8645.5300064, 4294967296: 21891.5783199, 8589934592: 50502.702330199994}, 'bench_ni': {1024: 674.5758423999999, 2048: 2.2115016, 4096: 2.2398713, 8192: 2.2473841, 16384: 2.1653015, 32768: 2.1896826000000003, 65536: 2.6394306000000003, 131072: 3.026367, 262144: 3.0640382, 524288: 3.8674564, 1048576: 5.1390968, 2097152: 7.0262735, 4194304: 11.7973831, 8388608: 20.6994241, 16777216: 37.671381, 33554432: 71.97144209999999, 67108864: 140.08426219999998, 134217728: 280.6791714, 268435456: 724.4559192, 536870912: 2127.6290672, 1073741824: 4066.9754417, 2147483648: 9147.4953689, 4294967296: 21632.8580295, 8589934592: 46861.815218}}


data_aws = {
    'bench_cpu': {
        1024: 530.9652684,
        2048: 1.343516,
        4096: 1.2865453,
        8192: 1.3212507,
        16384: 1.44446,
        32768: 1.5813194,
        65536: 1.8312595,
        131072: 2.4345412000000004,
        262144: 3.7378355,
        524288: 6.8105856,
        1048576: 11.9576991,
        2097152: 21.0112952,
        4194304: 40.5793594,
        8388608: 86.7785334,
        16777216: 173.65101180000002,
        33554432: 329.3855543,
        67108864: 672.1453807,
        134217728: 1333.2746427,
        268435456: 2653.4934946,
        536870912: 7312.4708793,
        1073741824: 15651.6386172,
        2147483648: 17807.178211,
        4294967296: 35842.608490800005,
        8589934592: 76128.23603089999},
    'bench_cl': {
        1024: 628.6633001,
        2048: 150.9315379,
        4096: 149.770964,
        8192: 150.50445159999998,
        16384: 148.8962544,
        32768: 148.26282659999998,
        65536: 148.3020427,
        131072: 148.6957343,
        262144: 148.2105051,
        524288: 148.2495284,
        1048576: 149.5506751,
        2097152: 150.8591455,
        4194304: 160.2549313,
        8388608: 174.2048375,
        16777216: 198.799181,
        33554432: 252.6645261,
        67108864: 376.93386039999996,
        134217728: 583.4957695,
        268435456: 1842.8317270999999,
        536870912: 4089.7308174,
        1073741824: 8734.751875700002,
        2147483648: 2972.1308796999997,
        4294967296: 15294.5170761,
        8589934592: 62314.6007337},
    'bench_ni': {
        1024: 559.702298,
        2048: 1.5870968,
        4096: 1.3474466,
        8192: 1.494734,
        16384: 1.3161338,
        32768: 1.3349174,
        65536: 1.526563,
        131072: 1.5077378000000001,
        262144: 1.6735919,
        524288: 2.5119358,
        1048576: 4.0754267,
        2097152: 6.2789713,
        4194304: 11.3181581,
        8388608: 28.8837678,
        16777216: 55.8139145,
        33554432: 123.8634284,
        67108864: 260.200198,
        134217728: 998.3255889,
        268435456: 2044.3389525,
        536870912: 4190.0037078000005,
        1073741824: 9254.717761700002,
        2147483648: 4298.6954842,
        4294967296: 12820.845666700001,
        8589934592: 58651.1292766}}

import matplotlib.pyplot as plt

if __name__ == "__main__":
    datas = {"Laptop": data_laptop, "AWS": data_aws}
    
    for name, data in datas.items():
        sizes = list(data["bench_cl"].keys())
        cl_times = list(data["bench_cl"].values())
        cpu_times = list(data["bench_cpu"].values())
        ni_times = list(data["bench_ni"].values())

        plt.figure()
        plt.loglog(sizes, cpu_times, "bo",
                sizes, cl_times, "rs",
                sizes, ni_times, "g^",
                sizes, gcrypt_times, "TODO")
        
        plt.legend(["Custom C", "OpenCL/GPU", "AES-NI", "gcrypt"])

        plt.xlabel("File Size (bytes)")
        plt.ylabel("Average time to encrypt across 10 executions (msec)");
        plt.title(f"Runtime Comparison for AES-128 Encryption Implementations ({name})")
        
        plt.show()
